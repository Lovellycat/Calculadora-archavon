<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archavon Cabana - Calculadora Profissional</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --bg-body: #1a1a1a;
            --card-main: #fcf9f2;
            --accent-red: #8b0000;
            --accent-brown: #a0522d;
            --text-color: #333;
            --border-color: #dcdcdc;
        }

        body { 
            font-family: Arial, sans-serif; 
            background-color: var(--bg-body); 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 450px;
            text-align: center;
        }

        /* Logo com relevo/destaque */
        .logo-img {
            width: 200px;
            margin-bottom: -30px;
            position: relative;
            z-index: 5;
            filter: drop-shadow(0 8px 10px rgba(0,0,0,0.6));
        }

        .main-card {
            background: var(--card-main);
            border-radius: 8px;
            border: 2px solid var(--accent-red);
            padding: 40px 20px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* Abas */
        .tabs {
            display: flex;
            background: #eee;
            margin-bottom: 20px;
            border-radius: 4px;
            overflow: hidden;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: #d2b48c; /* Tom pastel */
            color: white;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            font-family: Arial, sans-serif;
        }

        .tab-btn.active { background: var(--accent-red); }

        /* Blocos de Alimentos */
        .item-row {
            background: #fff;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
        }

        .item-label {
            color: var(--accent-red);
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 10px;
            display: block;
            text-transform: uppercase;
        }

        input[type="number"] {
            width: 80%;
            padding: 10px;
            border: 1px solid #333;
            border-radius: 4px;
            font-size: 1.2em;
            text-align: center;
            color: var(--text-color);
        }

        /* Resultados */
        .results-box {
            border: 2px dashed var(--accent-red);
            padding: 15px;
            margin-top: 20px;
            background: #fff;
            border-radius: 4px;
        }

        .res-line {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            font-size: 1em;
            font-weight: bold;
        }

        .val-repasse { color: #d9534f; }
        .val-liquido { color: #2e7d32; font-size: 1.2em; }

        button.btn-pdf {
            width: 100%;
            padding: 12px;
            background: #444;
            color: white;
            border: none;
            border-radius: 4px;
            margin-top: 15px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        button.btn-pdf:hover { background: #222; }

    </style>
</head>
<body>

<div class="container">
    <img src="logo.png" class="logo-img" alt="Archavon Cabana Logo">
    
    <div class="main-card">
        <div class="tabs">
            <button class="tab-btn active">Realizar Venda</button>
            <button class="tab-btn" style="opacity: 0.6; cursor: default;">Repasses</button>
        </div>

        <div class="item-row">
            <span class="item-label">Elixir da Saciedade (R$ 90)</span>
            <input type="number" id="inputE" value="0" min="0" oninput="calcularAutomatico()">
        </div>

        <div class="item-row">
            <span class="item-label">Ensopado Fortificante (R$ 90)</span>
            <input type="number" id="inputS" value="0" min="0" oninput="calcularAutomatico()">
        </div>

        <div class="results-box">
            <div class="res-line"><span>Total Bruto:</span> <span id="dispBruto">R$ 0</span></div>
            <div class="res-line"><span>Repasse (20%):</span> <span id="dispRepasse" class="val-repasse">R$ 0</span></div>
            <div class="res-line"><span>Total L铆quido:</span> <span id="dispLiquido" class="val-liquido">R$ 0</span></div>
        </div>

        <button class="btn-pdf" onclick="registrarEGerar()">
             Gerar Comprovante (Hist贸rico)
        </button>
    </div>
</div>

<script>
    // Hist贸rico para o PDF
    let historicoVendas = [];

    function calcularAutomatico() {
        const preco = 90;
        const qE = parseInt(document.getElementById('inputE').value) || 0;
        const qS = parseInt(document.getElementById('inputS').value) || 0;

        const bruto = (qE + qS) * preco;
        const repasse = bruto * 0.20;
        const liquido = bruto - repasse;

        document.getElementById('dispBruto').innerText = `R$ ${bruto}`;
        document.getElementById('dispRepasse').innerText = `R$ ${repasse}`;
        document.getElementById('dispLiquido').innerText = `R$ ${liquido}`;

        return { qE, qS, bruto, repasse, liquido };
    }

    function registrarEGerar() {
        const dados = calcularAutomatico();
        
        // S贸 registra se houver venda
        if (dados.bruto > 0) {
            historicoVendas.push({
                ...dados,
                data: new Date().toLocaleTimeString()
            });
            alert("Venda registrada no hist贸rico do PDF!");
        }

        if (historicoVendas.length === 0) {
            alert("Nenhuma venda realizada para gerar hist贸rico.");
            return;
        }

        gerarPDF();
    }

    function gerarPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        let y = 40;

        doc.setFont("arial", "bold");
        doc.setFontSize(18);
        doc.text("HISTRICO DE VENDAS - ARCHAVON CABANA", 20, 20);
        doc.setFontSize(10);
        doc.text(`Relat贸rio gerado em: ${new Date().toLocaleString()}`, 20, 28);
        doc.line(20, 32, 190, 32);

        let totalGeralBruto = 0;
        let totalGeralRepasse = 0;

        historicoVendas.forEach((venda, index) => {
            doc.setFont("arial", "bold");
            doc.text(`VENDA #${index + 1} - [${venda.data}]`, 20, y);
            doc.setFont("arial", "normal");
            doc.text(`Itens: ${venda.qE} Elixir | ${venda.qS} Ensopado`, 25, y + 7);
            doc.text(`Bruto: R$ ${venda.bruto} | Repasse: R$ ${venda.repasse}`, 25, y + 14);
            
            totalGeralBruto += venda.bruto;
            totalGeralRepasse += venda.repasse;
            y += 25;

            // Criar nova p谩gina se ficar muito longo
            if (y > 270) { doc.addPage(); y = 20; }
        });

        doc.line(20, y, 190, y);
        doc.setFont("arial", "bold");
        doc.text(`RESUMO DO TURNO:`, 20, y + 10);
        doc.text(`TOTAL BRUTO ACUMULADO: R$ ${totalGeralBruto}`, 20, y + 18);
        doc.text(`TOTAL REPASSE DEVIDO (20%): R$ ${totalGeralRepasse}`, 20, y + 26);

        doc.save(`historico_caixa_${Date.now()}.pdf`);
    }
</script>

</body>
</html>
