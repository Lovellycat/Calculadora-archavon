<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archavon Cabana - Calculadora Profissional</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #1a1a1a; 
            display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; margin: 0; padding: 20px;
        }
        .container { width: 100%; max-width: 600px; text-align: center; }
        .logo-img { 
            width: 200px; margin-bottom: -30px; position: relative; z-index: 5;
            filter: drop-shadow(0 8px 10px rgba(0,0,0,0.6));
        }
        .main-card {
            background: #fcf9f2; border-radius: 12px; border: 2px solid #8b0000;
            padding: 40px 20px 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; gap: 15px;
        }
        .tabs { display: flex; border-radius: 8px; overflow: hidden; margin-bottom: 10px; }
        .tab-btn { 
            flex: 1; padding: 12px; border: none; cursor: pointer; font-weight: bold; 
            text-transform: uppercase; font-family: Arial, sans-serif; background: #d2b48c; color: white;
        }
        .tab-btn.active { background: #8b0000; }
        .content { display: none; }
        .content.active { display: grid; grid-template-columns: 1.5fr 1fr; gap: 20px; }
        
        .left-panel { display: flex; flex-direction: column; gap: 10px; }
        .item-row { 
            display: flex; align-items: center; justify-content: space-between; 
            background: #fff; padding: 10px 15px; border-radius: 8px; border: 1px solid #ddd;
        }
        .item-row label { color: #8b0000; font-weight: bold; font-size: 0.9em; text-transform: uppercase; }
        .item-row input { width: 60px; padding: 8px; text-align: center; border: 1px solid #333; border-radius: 4px; font-size: 1em; }
        
        .right-panel { 
            background: #fff; border: 1px dashed #8b0000; border-radius: 8px; 
            padding: 15px; display: flex; flex-direction: column; justify-content: space-between;
        }
        .results-box h3 { margin-top: 0; color: #8b0000; font-size: 1.1em; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .res-line { display: flex; justify-content: space-between; margin: 8px 0; font-weight: bold; font-size: 0.9em; }
        
        .btn-group { display: flex; flex-direction: column; gap: 8px; margin-top: 10px; }
        .btn { 
            padding: 10px; border: none; border-radius: 4px; font-weight: bold; 
            cursor: pointer; text-transform: uppercase; font-family: Arial, sans-serif;
        }
        .btn-confirm { background: #a0522d; color: white; }
        .btn-clear { background: #999; color: white; font-size: 0.8em; }
        .btn-pdf { background: #333; color: white; margin-top: 5px; }

        .repasse-text { font-size: 0.9em; color: #444; line-height: 1.4; text-align: left; padding: 10px; }
    </style>
</head>
<body>

<div class="container">
    <img src="logo.png" class="logo-img" alt="Logo">
    <div class="main-card">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(event, 'venda')">Venda</button>
            <button class="tab-btn" onclick="switchTab(event, 'repasse')">Repasse</button>
        </div>

        <div id="venda" class="content active">
            <div class="left-panel">
                <div class="item-row">
                    <label>Elixir da Saciedade</label>
                    <input type="number" id="qE" value="0" min="0" oninput="updateCalc()">
                </div>
                <div class="item-row">
                    <label>Ensopado Fortificante</label>
                    <input type="number" id="qS" value="0" min="0" oninput="updateCalc()">
                </div>
                <div class="btn-group">
                    <button class="btn btn-confirm" onclick="confirmarVenda()">Confirmar Venda</button>
                    <button class="btn btn-clear" onclick="limpar()">Zerar Venda Atual</button>
                    <button class="btn btn-pdf" onclick="gerarPDF()">üìÑ Gerar Comprovante (Hist√≥rico)</button>
                </div>
            </div>

            <div class="right-panel">
                <div class="results-box">
                    <h3>Resultados</h3>
                    <div class="res-line"><span>Total Bruto:</span> <span id="dB">R$ 0</span></div>
                    <div class="res-line"><span>Repasse (20%):</span> <span id="dR" style="color:#d9534f">R$ 0</span></div>
                    <div class="res-line"><span>Total L√≠quido:</span> <span id="dL" style="color:#2e7d32">R$ 0</span></div>
                </div>
            </div>
        </div>

        <div id="repasse" class="content">
            <div class="repasse-text" style="grid-column: span 2;">
                <h3 style="color:#8b0000">Realizar Venda</h3>
                <p>Todo vendedor repassa <b>20%</b> de cada venda ao estabelecimento. Este valor refere-se ao custo de ingredientes e manuten√ß√£o m√≠stica do <b>Archavon Cabana Saloon</b>.</p>
                <p>O lucro l√≠quido (80%) pertence ao vendedor pela presta√ß√£o do servi√ßo.</p>
            </div>
        </div>
    </div>
</div>

<script>
    let historico = [];

    function switchTab(evt, tabId) {
        document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        evt.currentTarget.classList.add('active');
    }

    function updateCalc() {
        let e = parseInt(document.getElementById('qE').value) || 0;
        let s = parseInt(document.getElementById('qS').value) || 0;
        let bruto = (e + s) * 90;
        let rep = bruto * 0.2;
        let liq = bruto - rep;

        document.getElementById('dB').innerText = `R$ ${bruto}`;
        document.getElementById('dR').innerText = `R$ ${rep}`;
        document.getElementById('dL').innerText = `R$ ${liq}`;
        return { e, s, bruto, rep, liq };
    }

    function confirmarVenda() {
        let d = updateCalc();
        if (d.bruto === 0) return alert("Insira quantidades!");
        historico.push({...d, data: new Date().toLocaleTimeString()});
        alert("Venda adicionada ao hist√≥rico!");
    }

    function limpar() {
        document.getElementById('qE').value = 0;
        document.getElementById('qS').value = 0;
        updateCalc();
    }

    function gerarPDF() {
        if (historico.length === 0) return alert("Sem vendas confirmadas!");
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        let y = 40;
        doc.setFont("arial", "bold");
        doc.text("HIST√ìRICO DE TURNO - ARCHAVON CABANA", 20, 20);
        doc.setFontSize(10);
        doc.text(`Emitido em: ${new Date().toLocaleString()}`, 20, 28);
        doc.line(20, 32, 190, 32);

        let tB = 0, tR = 0;
        historico.forEach((v, i) => {
            doc.text(`VENDA #${i+1} (${v.data}) - Bruto: R$ ${v.bruto} | Repasse: R$ ${v.rep}`, 20, y);
            tB += v.bruto; tR += v.rep; y += 10;
        });
        doc.line(20, y, 190, y);
        doc.text(`TOTAL BRUTO ACUMULADO: R$ ${tB}`, 20, y + 10);
        doc.text(`TOTAL REPASSE DEVIDO: R$ ${tR}`, 20, y + 20);
        doc.save(`caixa_archavon_${Date.now()}.pdf`);
    }
</script>
</body>
</html>
